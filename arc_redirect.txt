# arc_redirect v0.1-dev
# Love redirects, hate 404s
# Andy Carter
# http://redhotchilliproject.com/

# ......................................................................
# This is a plugin for Textpattern - http://textpattern.com/
# To install: textpattern > admin > plugins
# Paste the following text into the 'Install plugin' box:
# ......................................................................

YToxMTp7czo0OiJuYW1lIjtzOjEyOiJhcmNfcmVkaXJlY3QiO3M6NzoidmVyc2lvbiI7czo3
OiIwLjEtZGV2IjtzOjY6ImF1dGhvciI7czoxMToiQW5keSBDYXJ0ZXIiO3M6MTA6ImF1dGhv
cl91cmkiO3M6MzE6Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0LmNvbS8iO3M6MTE6ImRl
c2NyaXB0aW9uIjtzOjI1OiJMb3ZlIHJlZGlyZWN0cywgaGF0ZSA0MDRzIjtzOjU6Im9yZGVy
IjtzOjE6IjUiO3M6NDoidHlwZSI7czoxOiIxIjtzOjU6ImZsYWdzIjtzOjE6IjIiO3M6NDoi
aGVscCI7czoyMTU4OiIJPGgxIGNsYXNzPSJ0aXRsZSI+YXJjX3JlZGlyZWN0IChsb3ZlIHJl
ZGlyZWN0cywgaGF0ZSA0MDRzKTwvaDE+CgoJPHA+SWYgeW91JiM4MjE3O3JlIGluIHRoZSBw
cm9jZXNzIG9mIHJlc3RydWN0dXJpbmcgYSBUZXh0cGF0dGVybiBzaXRlLCB0aGVuIHRoaXMg
aXMgdGhlIHBsdWdpbiBmb3IgeW91ITwvcD4KCgk8cD5SZXF1aXJlbWVudHM6LTwvcD4KCgk8
dWw+CgkJPGxpPlRleHRwYXR0ZXJuIDQuMis8L2xpPgoJPC91bD4KCgk8aDIgY2xhc3M9InNl
Y3Rpb24iPkF1dGhvcjwvaDI+CgoJPHA+PGEgaHJlZj0iaHR0cDovL3JlZGhvdGNoaWxsaXBy
b2plY3QuY29tIj5BbmR5IENhcnRlcjwvYT4uIEZvciBvdGhlciBUZXh0cGF0dGVybiBwbHVn
aW5zIGJ5IG1lIHZpc2l0IG15IDxhIGhyZWY9Imh0dHA6Ly9yZWRob3RjaGlsbGlwcm9qZWN0
LmNvbS90eHAiPlBsdWdpbnMgcGFnZTwvYT4uPC9wPgoKCTxwPlRoYW5rcyB0byA8YSBocmVm
PSJodHRwOi8vb2xpdmVya2VyLmNvLnVrLyI+T2xpdmVyIEtlcjwvYT4gZm9yIGdpdmluZyBt
ZSB0aGUgaWRlYSBmb3IgdGhpcyBwbHVnaW4uPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiI+
SW5zdGFsbGF0aW9uIC8gVW5pbnN0YWxsYXRpb248L2gyPgoKCTxwPlRvIGluc3RhbGwgZ28g
dG8gdGhlICYjODIxNjtwbHVnaW5zJiM4MjE3OyB0YWIgdW5kZXIgJiM4MjE2O2FkbWluJiM4
MjE3OyBhbmQgcGFzdGUgdGhlIHBsdWdpbiBjb2RlIGludG8gdGhlICYjODIxNjtJbnN0YWxs
IHBsdWdpbiYjODIxNzsgYm94LCAmIzgyMTY7dXBsb2FkJiM4MjE3OyBhbmQgdGhlbiAmIzgy
MTY7aW5zdGFsbCYjODIxNzsuIEZpbmFsbHkgYWN0aXZhdGUgdGhlIHBsdWdpbi48L3A+CgoJ
PHA+VG8gdW5pbnN0YWxsIDxzcGFuIGNsYXNzPSJ0YWciPmFyY19yZWRpcmVjdDwvc3Bhbj4g
c2ltcGx5IGRlbGV0ZSB0aGUgcGx1Z2luIGZyb20gdGhlICYjODIxNjtQbHVnaW5zJiM4MjE3
OyB0YWIuICBUaGlzIHdpbGwgcmVtb3ZlIHRoZSBwbHVnaW4gY29kZSBhbmQgZHJvcCB0aGUg
PHNwYW4gY2xhc3M9InRhZyI+YXJjX3JlZGlyZWN0PC9zcGFuPiB0YWJsZSBmcm9tIHlvdXIg
VGV4dHBhdHRlcm4gZGF0YWJhc2UuPC9wPgoKCTxoMiBjbGFzcz0ic2VjdGlvbiI+VXNhZ2U8
L2gyPgoKCTxwPjxzcGFuIGNsYXNzPSJ0YWciPmFyY19yZWRpcmVjdDwvc3Bhbj4gYWRkcyBh
IG5ldyB0YWIgdW5kZXIgJiM4MjE2O0V4dGVuc2lvbnMmIzgyMTc7IGZyb20gd2hlcmUgeW91
IGNhbiBkZWZpbmUgcGFpcnMgb2YgPHNwYW4gY2xhc3M9ImNhcHMiPlVSTDwvc3Bhbj5zIGZv
ciBoYW5kbGluZyByZWRpcmVjdHMuIEJhc2ljYWxseSBwcm92aWRlIGFuIG9yaWdpbmFsIDxz
cGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IG9uIHlvdXIgVGV4dHBhdHRlcm4gc2l0ZSB0
aGF0IGlzIGdlbmVyYXRpbmcgYSA0MDQsICYjODIyMDtwYWdlIG5vdCBmb3VuZCYjODIyMTss
IGVycm9yIGFuZCBhIHJlZGlyZWN0IDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+LiBU
aGVuIHdoZW5ldmVyIHNvbWVvbmUgZ29lcyB0byB0aGUgb3JpZ2luYWwgPHNwYW4gY2xhc3M9
ImNhcHMiPlVSTDwvc3Bhbj4gcmF0aGVyIHRoYW4gZ2V0IHRoZSBzdGFuZGFyZCA0MDQgZXJy
b3IgcGFnZSB0aGV5IHdpbGwgYmUgcmVkaXJjdGVkIHRvIHRoZSBuZXcgPHNwYW4gY2xhc3M9
ImNhcHMiPlVSTDwvc3Bhbj4gKHdpdGggYSAzMDEgcGVybWVuYW50ZWx5IG1vdmVkKS48L3A+
CgoJPHA+VGhlIG9yaWdpbmFsIDxzcGFuIGNsYXNzPSJjYXBzIj5VUkw8L3NwYW4+IG11c3Qg
cHJvZHVjZSBhIDQwNCBwYWdlIGluIFRleHRwYXR0ZXJuIG9uIHRoZSBzaXRlIHRoaXMgcGx1
Z2luIGlzIGluc3RhbGxlZC48L3A+CgoJPHVsPgoJCTxsaT48c3BhbiBjbGFzcz0idGFnIj5h
cmNfcmVkaXJlY3Q8L3NwYW4+IHRyZWF0cyBodHRwOi8vd3d3LmV4YW1wbGUuY29tL21pc3Np
bmcgdGhlIHNhbWUgYXMgaHR0cDovL3d3dy5leGFtcGxlLmNvbS9taXNzaW5nLzwvbGk+CgkJ
PGxpPjxzcGFuIGNsYXNzPSJ0YWciPmFyY19yZWRpcmVjdDwvc3Bhbj4gZG9lcyBub3QgdHJl
YXQgaHR0cDovL2V4YW1wbGUuY29tL21pc3NpbmcgYW5kIGh0dHA6Ly93d3cuZXhhbXBsZS5j
b20vbWlzc2luZyBhcyB0aGUgc2FtZSA8c3BhbiBjbGFzcz0iY2FwcyI+VVJMPC9zcGFuPjwv
bGk+Cgk8L3VsPgoKIjtzOjQ6ImNvZGUiO3M6Njk4MzoicmVnaXN0ZXJfY2FsbGJhY2soJ2Fy
Y19yZWRpcmVjdF9pbnN0YWxsJywncGx1Z2luX2xpZmVjeWNsZS5hcmNfcmVkaXJlY3QnLCAn
aW5zdGFsbGVkJyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdhcmNfcmVkaXJlY3RfdW5pbnN0YWxs
JywncGx1Z2luX2xpZmVjeWNsZS5hcmNfcmVkaXJlY3QnLCAnZGVsZXRlZCcpOwpyZWdpc3Rl
cl9jYWxsYmFjaygnYXJjX3JlZGlyZWN0JywgJ3R4cF9kaWUnLCA0MDQpOwphZGRfcHJpdnMo
J2FyY19yZWRpcmVjdCcsICcxLDIsMyw0Jyk7CnJlZ2lzdGVyX3RhYignZXh0ZW5zaW9ucycs
ICdhcmNfcmVkaXJlY3QnLCAnYXJjX3JlZGlyZWN0Jyk7CnJlZ2lzdGVyX2NhbGxiYWNrKCdh
cmNfcmVkaXJlY3RfdGFiJywgJ2FyY19yZWRpcmVjdCcpOwoKLyoKICogQ2hlY2sgZm9yIHJl
ZGlyZWN0ZWQgVVJMcyBhbmQgZm9yd2FyZCB3aXRoIGEgMzAxIHdoZXJlIG5lY2Vzc2FyeS4K
ICovCmZ1bmN0aW9uIGFyY19yZWRpcmVjdCgkZXZlbnQsICRzdGVwKSB7CiAgJHVybCA9IFBS
T1RPQ09MLiRfU0VSVkVSWydTRVJWRVJfTkFNRSddLiRfU0VSVkVSWydSRVFVRVNUX1VSSSdd
OwoKICAvLyBTdHJpcCBmaW5hbCBzbGFzaCBmcm9tIHVybAogIGlmIChzdWJzdHIoJHVybCwt
MSk9PScvJykgeyAkdXJsID0gc3Vic3RyKCR1cmwsIDAsIC0xKTsgfQoKICAkc3FsID0gIlNF
TEVDVCByZWRpcmVjdFVybCBGUk9NICIuUEZYLiJhcmNfcmVkaXJlY3QgV0hFUkUgb3JpZ2lu
YWxVcmwgPSAnIi4kdXJsLiInOyI7CiAgJHJzID0gc2FmZV9xdWVyeSgkc3FsKTsgJHJlZGly
ZWN0ID0gbmV4dFJvdygkcnMpOwoKCSAgaWYgKCRyZWRpcmVjdFsncmVkaXJlY3RVcmwnXSkg
ewoJCSAgb2JfZW5kX2NsZWFuKCk7CgoJCSAgaGVhZGVyKCJTdGF0dXM6IDMwMSIpOwoJCSAg
aGVhZGVyKCJIVFRQLzEuMCAzMDEgTW92ZWQgUGVybWFuZW50bHkiKTsKCQkgIGhlYWRlcigi
TG9jYXRpb246ICIuJHJlZGlyZWN0WydyZWRpcmVjdFVybCddLCBUUlVFLCAzMDEpOwoKCQkg
IC8vIEluIGNhc2UgdGhlIGhlYWRlcigpIG1ldGhvZCBmYWlscywgZmFsbCBiYWNrIG9uIGEg
Y2xhc3NpYyByZWRpcmVjdAoJCSAgZWNobyAnPGh0bWw+PGhlYWQ+PE1FVEEgSFRUUC1FUVVJ
Vj0iUmVmcmVzaCIgQ09OVEVOVD0iMDtVUkw9JwoJCSAgICAuJHBlcm1saW5rLiciPjwvaGVh
ZD48Ym9keT48L2JvZHk+PC9odG1sPic7CgkJICBkaWUoKTsKCSAgfQoKfQoKZnVuY3Rpb24g
YXJjX3JlZGlyZWN0X3RhYigkZXZlbnQsICRzdGVwKSB7CiAgc3dpdGNoICgkc3RlcCkgewog
ICAgY2FzZSAnYWRkJzogYXJjX3JlZGlyZWN0X2FkZCgpOyBicmVhazsKICAgIGNhc2UgJ3Nh
dmUnOiBhcmNfcmVkaXJlY3Rfc2F2ZSgpOyBicmVhazsKICAgIGNhc2UgJ2VkaXQnOiBhcmNf
cmVkaXJlY3RfZWRpdCgpOyBicmVhazsKICAgIGNhc2UgJ2FyY19yZWRpcmVjdF9tdWx0aV9l
ZGl0JzogYXJjX3JlZGlyZWN0X211bHRpZWRpdCgpOyBicmVhazsKICAgIGRlZmF1bHQ6IGFy
Y19yZWRpcmVjdF9saXN0KCk7CiAgfQp9CgpmdW5jdGlvbiBhcmNfcmVkaXJlY3RfbGlzdCgk
bWVzc2FnZSA9ICcnKSB7CgogIHBhZ2V0b3AoJ2FyY19yZWRpcmVjdCcsJG1lc3NhZ2UpOwoK
ICAkc3FsID0gIlNFTEVDVCAqIEZST00gIi5QRlguImFyY19yZWRpcmVjdDsiOwogICRycyA9
IHNhZmVfcXVlcnkoJHNxbCk7CgogIC8vIEluY2x1ZGUgYSBxdWljayBhZGQgZm9ybQogICRo
dG1sID0gZm9ybSgKICAgIHN0YXJ0VGFibGUoJ2VkaXQnKQogICAgICAudHIoCiAgICAgICAg
dGRhKHRhZygnT3JpZ2luYWwgVVJMJywnbGFiZWwnLCAnIGZvcj0ib3JpZ2luYWxVcmwiJyks
JyBzdHlsZT0idmVydGljYWwtYWxpZ246bWlkZGxlIicpCiAgICAgICAgLnRkKGZJbnB1dCgn
dGV4dCcsJ29yaWdpbmFsVXJsJywnJywnZWRpdCcsJycsJycsJycsJycsJ29yaWdpbmFsVXJs
JykpCiAgICAgICkudHIoCiAgICAgICAgdGRhKHRhZygnUmVkaXJlY3QgVVJMJywnbGFiZWwn
LCAnIGZvcj0icmVkaXJlY3RVcmwiJyksJyBzdHlsZT0idmVydGljYWwtYWxpZ246bWlkZGxl
IicpCiAgICAgICAgLnRkKGZJbnB1dCgndGV4dCcsJ3JlZGlyZWN0VXJsJywnJywnZWRpdCcs
JycsJycsJycsJycsJ3JlZGlyZWN0VXJsJykKICAgICAgICAuZUlucHV0KCdhcmNfcmVkaXJl
Y3QnKQogICAgICAgIC5zSW5wdXQoJ2FkZCcpLicmbmJzcDsnLmZJbnB1dCgnc3VibWl0Jywn
YWRkJyxnVHh0KCdBZGQnKSwncHVibGlzaCcpCiAgICAgICAgKQogICAgICApCiAgICAuZW5k
VGFibGUoKQogICwgJ21hcmdpbi1ib3R0b206MjVweCcpOwoKICAvLyBBZGQgYSBsaXN0IG9m
IGV4aXN0aW5nIHJlZGlyZWN0cwogICRodG1sIC49IG4ubi4nPGZvcm0gYWN0aW9uPSJpbmRl
eC5waHAiIGlkPSJhcmNfcmVkaXJlY3RfZm9ybSIgbWV0aG9kPSJwb3N0IiBuYW1lPSJsb25n
Zm9ybSIgb25zdWJtaXQ9InJldHVybiB2ZXJpZnkoXCcnLmdUeHQoJ2FyZV95b3Vfc3VyZScp
LidcJykiPic7CiAgJGh0bWwgLj0gc3RhcnRUYWJsZSgnbGlzdCcpOwoKICAkaHRtbCAuPSB0
cigKICAgIGhDZWxsKCdJRCMnKQogICAgLmhDZWxsKCkKICAgIC5oQ2VsbCgnT3JpZ2luYWwg
VVJMJykKICAgIC5oQ2VsbCgnUmVkaXJlY3QgVVJMJykKICAgIC5oQ2VsbCgpCiAgKTsKCiAg
d2hpbGUgKCRyZWRpcmVjdCA9IG5leHRSb3coJHJzKSkgewogICAgJGVkaXRMaW5rID0gaHJl
ZihnVHh0KCdlZGl0JyksCiAgICAgICc/ZXZlbnQ9YXJjX3JlZGlyZWN0JmFtcDtzdGVwPWVk
aXQmYW1wO2lkPScuJHJlZGlyZWN0WydhcmNfcmVkaXJlY3RJRCddKTsKICAgICRyZWRpcmVj
dExpbmsgPSBocmVmKCdUZXN0JywkcmVkaXJlY3RbJ29yaWdpbmFsVXJsJ10pOwogICAgJGh0
bWwgLj0gdHIoCiAgICAgIHRkKCRyZWRpcmVjdFsnYXJjX3JlZGlyZWN0SUQnXSwgMjAsICdp
ZCcpCiAgICAgIC50ZCgiPHVsPjxsaSBjbGFzcz0nYWN0aW9uLWVkaXQnPiRlZGl0TGluazwv
bGk+PGxpIGNsYXNzPSdhY3Rpb24tdmlldyc+JHJlZGlyZWN0TGluazwvbGk+PC91bD4iLCAz
NSwgJ2FjdGlvbnMnKQogICAgICAudGQoJHJlZGlyZWN0WydvcmlnaW5hbFVybCddLCAxNzUp
CiAgICAgIC50ZCgkcmVkaXJlY3RbJ3JlZGlyZWN0VXJsJ10sIDE3NSkKICAgICAgLnRkKGZJ
bnB1dCgnY2hlY2tib3gnLCAnc2VsZWN0ZWRbXScsICRyZWRpcmVjdFsnYXJjX3JlZGlyZWN0
SUQnXSksICcnLCAnbXVsdGktZWRpdCcpCiAgICApOwogIH0KCiAgJGh0bWwgLj0gbi4nPHRm
b290PicudHIoCiAgICAgIHRkYShzZWxlY3RfYnV0dG9ucygpCiAgICAgIC5ldmVudF9tdWx0
aWVkaXRfZm9ybSgnYXJjX3JlZGlyZWN0JywgYXJyYXkoJ2RlbGV0ZSc9PmdUeHQoJ2RlbGV0
ZScpKSwxLCcnLCcnLCcnLCcnKSwKICAgICAgJyBjbGFzcz0ibXVsdGktZWRpdCIgY29sc3Bh
bj0iNSIgc3R5bGU9InRleHQtYWxpZ246cmlnaHQ7Ym9yZGVyOm5vbmUiJykKICAgICkubi4n
PC90Zm9vdD4nOwoKICAkaHRtbCAuPSBlbmRUYWJsZSgpOwogICRodG1sIC49ICc8L2Zvcm0+
JzsKCiAgZWNobyAkaHRtbDsKCn0KCmZ1bmN0aW9uIGFyY19yZWRpcmVjdF9lZGl0KCRtZXNz
YWdlPScnKSB7CiAgcGFnZXRvcCgnYXJjX3JlZGlyZWN0JywkbWVzc2FnZSk7CgogICRvcmln
aW5hbFVybCA9IGdwcygnb3JpZ2luYWxVcmwnKTsKICAkcmVkaXJlY3RVcmwgPSBncHMoJ3Jl
ZGlyZWN0VXJsJyk7CgogIGlmICgkaWQ9Z3BzKCdpZCcpKSB7CiAgICAkcnMgPSBzYWZlX3Jv
dygnb3JpZ2luYWxVcmwscmVkaXJlY3RVcmwnLCAnYXJjX3JlZGlyZWN0JywgImFyY19yZWRp
cmVjdElEID0gJGlkIik7CiAgICBleHRyYWN0KCRycyk7CiAgfQoKICAkaHRtbCA9IGZvcm0o
CiAgICBzdGFydFRhYmxlKCdlZGl0JykKICAgICAgLnRyKAogICAgICAgIHRkYSh0YWcoJ09y
aWdpbmFsIFVSTCcsJ2xhYmVsJywgJyBmb3I9Im9yaWdpbmFsVXJsIicpLCcgc3R5bGU9InZl
cnRpY2FsLWFsaWduOm1pZGRsZSInKQogICAgICAgIC50ZChmSW5wdXQoJ3RleHQnLCdvcmln
aW5hbFVybCcsJG9yaWdpbmFsVXJsLCdlZGl0JywnJywnJywnJywnJywnb3JpZ2luYWxVcmwn
KSkKICAgICAgKS50cigKICAgICAgICB0ZGEodGFnKCdSZWRpcmVjdCBVUkwnLCdsYWJlbCcs
ICcgZm9yPSJyZWRpcmVjdFVybCInKSwnIHN0eWxlPSJ2ZXJ0aWNhbC1hbGlnbjptaWRkbGUi
JykKICAgICAgICAudGQoZklucHV0KCd0ZXh0JywncmVkaXJlY3RVcmwnLCRyZWRpcmVjdFVy
bCwnZWRpdCcsJycsJycsJycsJycsJ3JlZGlyZWN0VXJsJykKICAgICAgICAuZUlucHV0KCdh
cmNfcmVkaXJlY3QnKS4nJm5ic3A7JwogICAgICAgIC4oKCRpZCk/CiAgICAgICAgc0lucHV0
KCdzYXZlJykuaElucHV0KCdpZCcsJGlkKS5mSW5wdXQoJ3N1Ym1pdCcsJ3NhdmUnLGdUeHQo
J1NhdmUnKSwncHVibGlzaCcpCiAgICAgICAgICA6c0lucHV0KCdhZGQnKS5mSW5wdXQoJ3N1
Ym1pdCcsJ2FkZCcsZ1R4dCgnQWRkJyksJ3B1Ymxpc2gnKQogICAgICAgICkpCiAgICAgICkK
ICAgIC5lbmRUYWJsZSgpCiAgKTsKCiAgZWNobyAkaHRtbDsKCn0KCmZ1bmN0aW9uIGFyY19y
ZWRpcmVjdF9hZGQoKSB7CiAgJG9yaWdpbmFsVXJsID0gZ3BzKCdvcmlnaW5hbFVybCcpOwog
ICRyZWRpcmVjdFVybCA9IGdwcygncmVkaXJlY3RVcmwnKTsKCiAgaWYgKCRvcmlnaW5hbFVy
bCA9PT0gJycgfHwgJHJlZGlyZWN0VXJsID09PSAnJykgewogICAgYXJjX3JlZGlyZWN0X2Vk
aXQoJ1VuYWJsZSB0byBhZGQgbmV3IHJlZGlyZWN0Jyk7CiAgICByZXR1cm47CiAgfQoKICAv
LyBTdHJpcCBmaW5hbCBzbGFzaCBmcm9tIG9yaWdpbmFsIHVybAogIGlmIChzdWJzdHIoJG9y
aWdpbmFsVXJsLC0xKT09Jy8nKSB7CiAgICAkb3JpZ2luYWxVcmwgPSBzdWJzdHIoJG9yaWdp
bmFsVXJsLCAwLCAtMSk7CiAgfQoKICAkcSA9IHNhZmVfaW5zZXJ0KCJhcmNfcmVkaXJlY3Qi
LAogICAgIm9yaWdpbmFsVXJsID0gJyIudHJpbSgkb3JpZ2luYWxVcmwpLiInLCByZWRpcmVj
dFVybCA9ICciLnRyaW0oJHJlZGlyZWN0VXJsKS4iJyIKICApOwoKICAkR0xPQkFMU1snSUQn
XSA9IG15c3FsX2luc2VydF9pZCgpOwoKICBpZiAoJHEpIHsKICAgICRtZXNzYWdlID0gZ1R4
dCgnUmVkaXJlY3QgYWRkZWQnKTsKICAgIGFyY19yZWRpcmVjdF9saXN0KCRtZXNzYWdlKTsK
ICB9Cn0KCmZ1bmN0aW9uIGFyY19yZWRpcmVjdF9zYXZlKCkgewoKICBpZiAoISRpZD1ncHMo
J2lkJykpIHsKICAgIGFyY19yZWRpcmVjdF9saXN0KCdVbmFibGUgdG8gc2F2ZSByZWRpcmVj
dCcpOwogICAgcmV0dXJuOwogIH0KCiAgJG9yaWdpbmFsVXJsID0gZ3BzKCdvcmlnaW5hbFVy
bCcpOwogICRyZWRpcmVjdFVybCA9IGdwcygncmVkaXJlY3RVcmwnKTsKCiAgaWYgKCRvcmln
aW5hbFVybCA9PSAnJyB8fCAkcmVkaXJlY3RVcmwgPT0gJycpIHsKICAgIGFyY19yZWRpcmVj
dF9lZGl0KCdVbmFibGUgdG8gc2F2ZSByZWRpcmVjdCcpOwogICAgcmV0dXJuOwogIH0KCiAg
Ly8gU3RyaXAgZmluYWwgc2xhc2ggZnJvbSBvcmlnaW5hbCB1cmwKICBpZiAoc3Vic3RyKCRv
cmlnaW5hbFVybCwtMSk9PScvJykgewogICAgJG9yaWdpbmFsVXJsID0gc3Vic3RyKCRvcmln
aW5hbFVybCwgMCwgLTEpOwogIH0KCiAgJHJzID0gc2FmZV91cGRhdGUoImFyY19yZWRpcmVj
dCIsCiAgICAib3JpZ2luYWxVcmwgICAgPSAnIi50cmltKCRvcmlnaW5hbFVybCkuIicsICBy
ZWRpcmVjdFVybCA9ICciLnRyaW0oJHJlZGlyZWN0VXJsKS4iJyIsCiAgICAiYXJjX3JlZGly
ZWN0SUQgPSAkaWQiCiAgKTsKCiAgaWYgKCRycykgewogICAgJG1lc3NhZ2UgPSBnVHh0KCdS
ZWRpcmVjdCB1cGRhdGVkJyk7CiAgICBhcmNfcmVkaXJlY3RfbGlzdCgkbWVzc2FnZSk7CiAg
fQp9CgpmdW5jdGlvbiBhcmNfcmVkaXJlY3RfbXVsdGllZGl0KCkgewogICRzZWxlY3RlZCA9
IHBzKCdzZWxlY3RlZCcpOwoKICBpZiAoISRzZWxlY3RlZCB8fCAhaXNfYXJyYXkoJHNlbGVj
dGVkKSkgewogICAgYXJjX3JlZGlyZWN0X2xpc3QoKTsKICAgIHJldHVybjsKICB9CgogICRt
ZXRob2QgPSBwcygnZWRpdF9tZXRob2QnKTsKICAkY2hhbmdlZCA9IGFycmF5KCk7CgogICRt
ZXNzYWdlID0gJyc7CgogIHN3aXRjaCAoJG1ldGhvZCkgewogICAgY2FzZSAnZGVsZXRlJzoK
CiAgICAgIGZvcmVhY2ggKCRzZWxlY3RlZCBhcyAkaWQpIHsKICAgICAgICBpZiAoc2FmZV9k
ZWxldGUoJ2FyY19yZWRpcmVjdCcsICdhcmNfcmVkaXJlY3RJRCA9ICcuJGlkKSkgewogICAg
ICAgICAgJGNoYW5nZWRbXSA9ICRpZDsKICAgICAgICB9CiAgICAgIH0KICAgICAgJG1lc3Nh
Z2UgPSBjb3VudCgkY2hhbmdlZCkuJyByZWRpcmVjdHMgZGVsZXRlZCc7CiAgICAgIGJyZWFr
OwogIH0KCiAgYXJjX3JlZGlyZWN0X2xpc3QoJG1lc3NhZ2UpOwp9CgovLyBJbnN0YWxsYXRp
b24gZnVuY3Rpb24gLSBidWlsZHMgTXlTUUwgdGFibGUKZnVuY3Rpb24gYXJjX3JlZGlyZWN0
X2luc3RhbGwoKQp7CgogIC8vIEZvciBmaXJzdCBpbnN0YWxsLCBjcmVhdGUgdGFibGUgZm9y
IHR3ZWV0cwogICRzcWwgPSAiQ1JFQVRFIFRBQkxFIElGIE5PVCBFWElTVFMgIi5QRlguImFy
Y19yZWRpcmVjdCAiOwogICRzcWwuPSAiKGFyY19yZWRpcmVjdElEIElOVEVHRVIgQVVUT19J
TkNSRU1FTlQgUFJJTUFSWSBLRVksCiAgICBvcmlnaW5hbFVybCBWQVJDSEFSKDI0MCksCiAg
ICByZWRpcmVjdFVybCBWQVJDSEFSKDI0MCkpOyI7CgogIGlmICghc2FmZV9xdWVyeSgkc3Fs
KSkgewogICAgcmV0dXJuICdFcnJvciAtIHVuYWJsZSB0byBjcmVhdGUgYXJjX3JlZGlyZWN0
IHRhYmxlJzsKICB9Cgp9CgovLyBVbmluc3RhbGwgZnVuY3Rpb24gLSBkZWxldGVzIE15U1FM
IHRhYmxlIGFuZCByZWxhdGVkIHByZWZlcmVuY2VzCgpmdW5jdGlvbiBhcmNfcmVkaXJlY3Rf
dW5pbnN0YWxsKCkKewogICRzcWwgPSAiRFJPUCBUQUJMRSBJRiBFWElTVFMgIi5QRlguImFy
Y19yZWRpcmVjdDsiOwogIGlmICghc2FmZV9xdWVyeSgkc3FsKSkgewogICAgcmV0dXJuICdF
cnJvciAtIHVuYWJsZSB0byBkZWxldGUgYXJjX3JlZGlyZWN0IHRhYmxlJzsKICB9Cn0iO3M6
MzoibWQ1IjtzOjMyOiIyYzEwZTgxMzlhNTNlN2QxMzU4ZGQ5NmVlMzQzMmZkMiI7fQ==
